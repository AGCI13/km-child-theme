document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".modal_pc_open_btn"),t=document.querySelector(".modal-postcode"),o=document.querySelectorAll(".modal-postcode-close"),n=document.querySelectorAll(".form-postcode");t.classList.contains("active")&&document.body.classList.add("modal-open"),e.forEach(e=>{e.addEventListener("click",function(){t.classList.add("active"),document.body.classList.add("modal-open")})}),o.forEach(e=>{e.addEventListener("click",function(){t.classList.remove("active"),document.body.classList.remove("modal-open")})}),n.forEach(e=>{e.addEventListener("submit",function(e){e.preventDefault(),e.stopPropagation(),a(e)})});const a=e=>{let o=e.target.querySelector(".country").value,n=e.target.querySelector(".zip_code").value,a=e.target.querySelector(".zip_code_label"),c=e.target.querySelector("#nonce_postcode");if(n.length<5&&"FR"===o||n.length<4&&"BE"===o)return void(a.textContent="Veuillez rentrez un code postal valide");const d={zip:n,country:o,nonce_postcode:c.value};handleLoading(e,!0),kmAjaxCall("postcode_submission_handler",d).then(c=>{c.success?(a.textContent="",setCookie("zip_code",n+"-"+o,30),setCookie("shipping_zone",c.data,30),setTimeout(()=>{t.style.display="none",location.reload()},400)):c.data&&"string"==typeof c.data.message?a.textContent=c.data.message:a.textContent="Une erreur inattendue est survenue. Veuillez rÃ©essayer.",handleLoading(e,!1)}).catch(t=>{a.textContent=t.message,handleLoading(e,!1)})}});