document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".modal_pc_open_btn"),t=document.querySelector(".modal-postcode"),o=document.querySelectorAll(".modal-postcode-close"),n=document.querySelectorAll(".form-postcode");t.classList.contains("active")&&document.body.classList.add("modal-open"),e.forEach(e=>{e.addEventListener("click",function(){t.classList.add("active"),document.body.classList.add("modal-open")})}),o.forEach(e=>{e.addEventListener("click",function(){t.classList.remove("active"),document.body.classList.remove("modal-open")})}),n.forEach(e=>{e.addEventListener("submit",function(e){e.preventDefault(),e.stopPropagation(),c(e)})});const c=e=>{let o=e.target.querySelector(".country").value,n=e.target.querySelector(".postcode"),c=n.value,s=e.target.querySelector(".postcode_label"),a=e.target.querySelector("#nonce_postcode");if(c.length<5&&"FR"===o||c.length<4&&"BE"===o)return void(s.textContent="Veuillez rentrez un code postal valide");n.setAttribute("disabled","disabled");const d={postcode:c,country:o,nonce_postcode:a.value};handleLoading(e,!0),kmAjaxCall("store_in_wc_session",d).then(e=>{e.success?(t.style.display="none",location.reload()):(s.textContent=e.data.message||"Une erreur inattendue est survenue. Veuillez rÃ©essayer.",n.removeAttribute("disabled"))}).catch(e=>{console.log(e.message),n.removeAttribute("disabled")})}});