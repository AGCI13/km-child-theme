document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".modal_pc_open_btn"),t=document.querySelector(".modal-postcode"),o=document.querySelectorAll(".modal-postcode-close"),n=document.querySelectorAll(".form-postcode");t.classList.contains("active")&&document.body.classList.add("modal-open"),e.forEach(e=>{e.addEventListener("click",function(){t.classList.add("active"),document.body.classList.add("modal-open")})}),o.forEach(e=>{e.addEventListener("click",function(){t.classList.remove("active"),document.body.classList.remove("modal-open")})}),n.forEach(e=>{e.addEventListener("submit",function(e){e.preventDefault(),e.stopPropagation(),a(e)})});const a=e=>{let o=e.target.querySelector(".country").value,n=e.target.querySelector(".zip_code"),a=n.value,d=e.target.querySelector(".zip_code_label"),s=e.target.querySelector("#nonce_postcode");if(a.length<5&&"FR"===o||a.length<4&&"BE"===o)return void(d.textContent="Veuillez rentrez un code postal valide");n.setAttribute("disabled","disabled");const c={zip:a,country:o,nonce_postcode:s.value};handleLoading(e,!0),kmAjaxCall("postcode_submission_handler",c).then(s=>{s.success?(d.textContent="",setCookie("zip_code",a+"-"+o,30),setCookie("shipping_zone",s.data,30),setTimeout(()=>{t.style.display="none",location.reload()},400)):(s.data&&"string"==typeof s.data.message?d.textContent=s.data.message:d.textContent="Une erreur inattendue est survenue. Veuillez rÃ©essayer.",n.removeAttribute("disabled")),handleLoading(e,!1)}).catch(t=>{console.log(t.message),handleLoading(e,!1)})}});