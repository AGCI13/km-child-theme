document.addEventListener("DOMContentLoaded",()=>{attachAjaxUpdateListener(),numberInputPlusMinus(),movePiOverallEstimateCart(),showCouponForm(),emailMarketingBox()});const attachAjaxUpdateListener=()=>{jQuery(document.body).on("updated_cart_totals",function(){numberInputPlusMinus()})},numberInputPlusMinus=()=>{const e=document.querySelectorAll('.woocommerce-cart-form .quantity input[type="number"]');e.forEach(e=>{const t=document.createElement("span");t.classList.add("qty-modifier","minus"),t.innerHTML="-",t.onclick=(()=>{e.value=Math.max(0,e.value-1),triggerChangeEvent(e)});const n=document.createElement("span");n.classList.add("qty-modifier","plus"),n.innerHTML="+",n.onclick=(()=>{e.value=parseInt(e.value)+1,triggerChangeEvent(e)}),e.parentNode.insertBefore(t,e),e.parentNode.appendChild(n);const r=()=>{setTimeout(()=>{jQuery("[name='update_cart']").trigger("click")},200)};t.addEventListener("mouseout",r),n.addEventListener("mouseout",r)})},triggerChangeEvent=e=>{const t=new Event("change",{bubbles:!0,cancelable:!0});e.dispatchEvent(t)},movePiOverallEstimateCart=()=>{const e=document.getElementById("pi-overall-estimate-cart"),t=document.querySelector(".shipping-info");e&&t&&t.parentNode&&t.parentNode.insertBefore(e,t.nextSibling)},emailMarketingBox=()=>{const e=document.getElementById("km-customer-email-marketing");e&&(confirmBtn=e.querySelector("#km-send-marketing-email"),confirmBtn&&confirmBtn.addEventListener("click",t=>{t.preventDefault(),console.log("click");const n=e.querySelector('input[name="km_cart_discount_email"]'),r=n?n.value:"";if(!r)return void(e.innerHTML="E-mail manquant.");const o=e.querySelector('input[name="km_cart_discount_email_nonce"]').value;confirmBtn.disabled=!0,loaderElement=document.createElement("div"),loaderElement.classList.add("km-spinner"),e.appendChild(loaderElement),kmAjaxCall("discount_cart_form",{discount_email:r,discount_cart_nonce:o}).then(t=>{loaderElement.remove(),console.log(t.data),!0===t.success?(successMessages=document.createElement("div"),successMessages.classList.add("woocommerce-success"),e.innerHTML=t.data):(errorMessages=document.createElement("div"),errorMessages.classList.add("woocommerce-error"),errorMessages.innerHTML=t.data,e.appendChild(errorMessages),setTimeout(()=>{e.removeChild(errorMessages)},3e3)),confirmBtn.disabled=!1})}))};jQuery(document).ready(function(e){function t(){var t=e(".cart_item td.product-remove").length;1===t&&e(".product-remove .remove").off("click").on("click",function(e){e.preventDefault(),document.querySelector(".clear-cart").click()})}t(),e(document.body).on("updated_cart_totals",function(){t(),showCouponForm()})});