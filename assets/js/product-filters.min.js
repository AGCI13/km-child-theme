document.addEventListener("DOMContentLoaded",()=>{function e(e,t,n,o){const[a,l]=c(t,n);s(t,n,"#C6C6C6","#25daa5",o),a>l?(e.value=l,t.value=l):e.value=a}function t(e,t,n,o){const[l,r]=c(t,n);s(t,n,"#C6C6C6","#BE9E67",o),a(n),l<=r?(e.value=r,n.value=r):n.value=l}function n(e,t,n){const[o,a]=c(e,t);s(e,t,"#C6C6C6","#BE9E67",t),o>a?(e.value=a,n.value=a,p.textContent=a):(n.value=o,p.textContent=o)}function o(e,t,n){const[o,l]=c(e,t);s(e,t,"#C6C6C6","#BE9E67",t),a(t),o<=l?(t.value=l,n.value=l,v.textContent=l):(n.value=o,t.value=o,v.textContent=o)}function c(e,t){const n=parseInt(e.value,10),o=parseInt(t.value,10);return[n,o]}function s(e,t,n,o,c){const s=t.max-t.min,a=e.value-t.min,l=t.value-t.min;c.style.background=`linear-gradient(\n            to right,\n            ${n} 0%,\n            ${n} ${a/s*100}%,\n            ${o} ${a/s*100}%,\n            ${o} ${l/s*100}%, \n            ${n} ${l/s*100}%, \n            ${n} 100%)`}function a(e){const t=document.querySelector("#toSlider");Number(e.value)<=0?t.style.zIndex=2:t.style.zIndex=0}function l(){i.value=i.min,m.value=m.max,p.textContent=i.min,v.textContent=m.max;var e=new Event("change");v.dispatchEvent(e),p.dispatchEvent(e),i.dispatchEvent(e),m.dispatchEvent(e)}const r=document.querySelectorAll(".km-product-filters_sliding-bar"),d=document.querySelector("#fromSlider"),u=document.querySelector("#toSlider"),i=document.querySelector("#fromInput"),m=document.querySelector("#toInput"),p=document.querySelector("#fromDisplay"),v=document.querySelector("#toDisplay"),h=document.querySelector(".km-product-filters_close");h.addEventListener("click",()=>{const e=document.querySelector(".km-product-filters_sliding-bar");document.body.classList.remove("modal-open"),e.classList.remove("open")}),r.forEach((e,t)=>{const n=e.querySelector(".km-product-filters__form"),o=e.querySelectorAll('input[type="checkbox"]'),c=document.querySelectorAll(".woocommerce-ordering")[t],s=document.querySelectorAll('input[type="reset"]')[t];let a=document.createElement("a"),r=document.createElement("span");r.classList.add("filters-separator"),r.textContent="|",c.prepend(r),a.textContent="Filtrer",a.classList.add("product-filters-link"),c.prepend(a),a.addEventListener("click",t=>{t.stopPropagation(),document.body.classList.toggle("modal-open"),e.classList.toggle("open"),e.classList.contains("active")||e.classList.add("active")}),document.body.addEventListener("click",t=>{document.body.classList.contains("modal-open")&&!e.contains(t.target)&&(document.body.classList.remove("modal-open"),e.classList.remove("open"))}),e.addEventListener("click",e=>{e.stopPropagation()}),s.addEventListener("click",e=>{e.preventDefault(),o.forEach(e=>{e.checked&&(e.closest(".km-product-filters__item").classList.remove("checked"),e.checked=!1)}),l(),n.querySelectorAll('[type="submit"]')[0].click()}),n.addEventListener("submit",t=>{t.preventDefault(),handleLoading(t,!0);let o=new FormData(n);const c={};o.forEach((e,t)=>{t.endsWith("[]")?(t=t.slice(0,-2),c.hasOwnProperty(t)||(c[t]=[]),c[t].push(e)):c[t]=e}),kmAjaxCall("filter_archive_products",c,{}).then(n=>{if(n.success){const t=document.querySelector(".products"),o=document.querySelector(".woocommerce-result-count"),c=document.querySelector(".woocommerce-pagination");console.log(n.data.found_results_count),n.data.found_results_count>0&&(document.body.classList.remove("modal-open"),e.classList.remove("open")),t&&(t.innerHTML=n.data.content_html),o&&(o.textContent=n.data.found_results_html),c&&c.remove()}handleLoading(t,!1)}).catch(e=>{n.textContent=e.message,handleLoading(t,!1)})}),o.forEach(e=>{e.addEventListener("change",function(){this.checked?this.closest(".km-product-filters__item").classList.add("checked"):this.closest(".km-product-filters__item").classList.remove("checked")})})}),s(d,u,"#C6C6C6","#BE9E67",u),a(u),d.oninput=(()=>n(d,u,i)),u.oninput=(()=>o(d,u,m)),i.oninput=(()=>e(d,i,m,u)),m.oninput=(()=>t(u,i,m,u)),d.onchange=(()=>n(d,u,i)),u.onchange=(()=>o(d,u,m)),i.onchange=(()=>e(d,i,m,u)),m.onchange=(()=>t(u,i,m,u))});