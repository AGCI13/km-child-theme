document.addEventListener("DOMContentLoaded",()=>{function e(e,t,n,o){const[l,a]=c(t,n);r(t,n,"#C6C6C6","#25daa5",o),l>a?(e.value=a,t.value=a):e.value=l}function t(e,t,n,o){const[a,s]=c(t,n);r(t,n,"#C6C6C6","#BE9E67",o),l(n),a<=s?(e.value=s,n.value=s):n.value=a}function n(e,t,n){const[o,l]=c(e,t);r(e,t,"#C6C6C6","#BE9E67",t),o>l?(e.value=l,n.value=l,p.textContent=l):(n.value=o,p.textContent=o)}function o(e,t,n){const[o,a]=c(e,t);r(e,t,"#C6C6C6","#BE9E67",t),l(t),o<=a?(t.value=a,n.value=a,v.textContent=a):(n.value=o,t.value=o,v.textContent=o)}function c(e,t){const n=parseInt(e.value,10),o=parseInt(t.value,10);return[n,o]}function r(e,t,n,o,c){const r=t.max-t.min,l=e.value-t.min,a=t.value-t.min;c.style.background=`linear-gradient(\n            to right,\n            ${n} 0%,\n            ${n} ${l/r*100}%,\n            ${o} ${l/r*100}%,\n            ${o} ${a/r*100}%, \n            ${n} ${a/r*100}%, \n            ${n} 100%)`}function l(e){const t=document.querySelector("#toSlider");Number(e.value)<=0?t.style.zIndex=2:t.style.zIndex=0}function a(){d.value=d.min,m.value=m.max,p.textContent=d.min,v.textContent=m.max;var e=new Event("change");v.dispatchEvent(e),p.dispatchEvent(e),d.dispatchEvent(e),m.dispatchEvent(e)}const s=document.querySelectorAll(".km-product-filters_sliding-bar"),i=document.querySelector("#fromSlider"),u=document.querySelector("#toSlider"),d=document.querySelector("#fromInput"),m=document.querySelector("#toInput"),p=document.querySelector("#fromDisplay"),v=document.querySelector("#toDisplay"),h=document.querySelector(".km-product-filters_close");let f=null;h.addEventListener("click",()=>{const e=document.querySelector(".km-product-filters_sliding-bar");document.body.classList.remove("modal-open"),e.classList.remove("open")}),s.forEach((e,t)=>{const n=e.querySelector(".km-product-filters__form"),o=e.querySelectorAll('input[type="checkbox"]'),c=document.querySelectorAll(".woocommerce-ordering")[t],r=document.querySelectorAll('input[type="reset"]')[t];let l=document.createElement("a"),s=document.createElement("span");s.classList.add("filters-separator"),s.textContent="|",c.prepend(s),l.textContent="Filtrer",l.classList.add("product-filters-link"),c.prepend(l),l.addEventListener("click",t=>{t.stopPropagation(),document.body.classList.toggle("modal-open"),e.classList.toggle("open"),e.classList.contains("active")||e.classList.add("active")}),document.body.addEventListener("click",t=>{document.body.classList.contains("modal-open")&&!e.contains(t.target)&&(document.body.classList.remove("modal-open"),e.classList.remove("open"))}),e.addEventListener("click",e=>{e.stopPropagation()}),r.addEventListener("click",e=>{if(e.preventDefault(),o.forEach(e=>{e.checked&&(e.closest(".km-product-filters__item").classList.remove("checked"),e.checked=!1)}),a(),null!==f){const e=document.querySelector(".grille-categorie");e&&(e.innerHTML=f)}}),n.addEventListener("submit",e=>{e.preventDefault(),handleLoading(e,!0);let t=new FormData(n);const o={};if(t.forEach((e,t)=>{t.endsWith("[]")?(t=t.slice(0,-2),o.hasOwnProperty(t)||(o[t]=[]),o[t].push(e)):o[t]=e}),null===f){const e=document.querySelector(".grille-categorie");e&&(f=e.innerHTML)}kmAjaxCall("filter_archive_products",o,{}).then(t=>{if(t.success){const e=document.querySelector(".products"),n=document.querySelector(".woocommerce-result-count"),o=document.querySelector(".woocommerce-pagination");e&&(e.innerHTML=t.data.content_html),n&&(n.textContent=t.data.found_results_html),o&&o.remove()}handleLoading(e,!1)}).catch(t=>{n.textContent=t.message,handleLoading(e,!1)})}),o.forEach(e=>{e.addEventListener("change",function(){this.checked?this.closest(".km-product-filters__item").classList.add("checked"):this.closest(".km-product-filters__item").classList.remove("checked")})})}),r(i,u,"#C6C6C6","#BE9E67",u),l(u),i.oninput=(()=>n(i,u,d)),u.oninput=(()=>o(i,u,m)),d.oninput=(()=>e(i,d,m,u)),m.oninput=(()=>t(u,d,m,u)),i.onchange=(()=>n(i,u,d)),u.onchange=(()=>o(i,u,m)),d.onchange=(()=>e(i,d,m,u)),m.onchange=(()=>t(u,d,m,u))});